---
phase: 03-app-like-variant-design
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - tests/eval/variants/registry.py
  - tests/eval/variants/tasks_rename.py
  - tests/eval/variants/tasks_simplify.py
  - tests/eval/variants/tasks_description_a.py
  - tests/eval/variants/tasks_description_b.py
autonomous: true
requirements:
  - EXPR-01

must_haves:
  truths:
    - "Registry accepts variants with multiple schedule tool names (schedule_tool_names list)"
    - "Rename variant uses app-like names (calendar_create_event, calendar_list_events, calendar_update_event) with identical params and descriptions to baseline"
    - "Simplify variant merges when+delay_seconds+recurring into single typed when parameter"
    - "Description A uses structured What/When/How format"
    - "Description B uses minimal examples-first format"
    - "All 4 isolated variants keep system prompt identical to baseline"
    - "Each variant is discoverable via VARIANTS dict"
  artifacts:
    - path: "tests/eval/variants/registry.py"
      provides: "Extended ToolVariant with schedule_tool_names support"
      contains: "schedule_tool_names"
    - path: "tests/eval/variants/tasks_rename.py"
      provides: "Rename-only variant with app-like tool names"
      contains: "calendar_create_event"
    - path: "tests/eval/variants/tasks_simplify.py"
      provides: "Simplify-only variant with merged when parameter"
      contains: "when: int | str"
    - path: "tests/eval/variants/tasks_description_a.py"
      provides: "Structured description variant"
      contains: "WHEN TO USE"
    - path: "tests/eval/variants/tasks_description_b.py"
      provides: "Minimal description variant"
      contains: "DESC_MINIMAL"
  key_links:
    - from: "tests/eval/variants/registry.py"
      to: "tests/eval/variants/tasks_rename.py"
      via: "auto-import at bottom of registry triggers @register decorator"
      pattern: "import tests.eval.variants.tasks_rename"
    - from: "tests/eval/evaluators.py"
      to: "tests/eval/variants/registry.py"
      via: "schedule_tool_name used in evaluate_tool_calls"
      pattern: "variant.schedule_tool_name"
---

<objective>
Extend the variant registry to support multi-tool variants and create 4 isolated-variable tool variants (rename-only, simplify-only, description-style-A, description-style-B).

Purpose: Each variant changes exactly ONE dimension from baseline, enabling Phase 4 to isolate which variable drives improvement.
Output: 4 new variant files registered in VARIANTS dict + registry extended with schedule_tool_names support.
</objective>

<execution_context>
@/Users/iorlas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/iorlas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-app-like-variant-design/03-RESEARCH.md
@tests/eval/variants/registry.py
@tests/eval/variants/tasks_baseline.py
@tests/eval/evaluators.py
@tests/eval/test_tasks.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend ToolVariant registry for multi-tool variants</name>
  <files>tests/eval/variants/registry.py</files>
  <action>
Add `schedule_tool_names: list[str] | None = None` field to `ToolVariant` dataclass. When set, it lists ALL tool names that count as "scheduling" tools (needed for the app-like variant which splits into calendar_create_event + reminders_create).

The existing `schedule_tool_name: str` field stays for backward compatibility. Evaluator logic already uses `variant.schedule_tool_name` -- no evaluator changes needed in this plan. The list field will be consumed in Plan 02's app-like variant and in Phase 4.

Also add auto-import lines at the bottom of registry.py for the 4 new variant modules:
```python
import tests.eval.variants.tasks_rename  # noqa: E402, F401
import tests.eval.variants.tasks_simplify  # noqa: E402, F401
import tests.eval.variants.tasks_description_a  # noqa: E402, F401
import tests.eval.variants.tasks_description_b  # noqa: E402, F401
```

Do NOT import tasks_applike yet -- that's Plan 02.
  </action>
  <verify>
`uv run python -c "from tests.eval.variants.registry import ToolVariant; v = ToolVariant(name='x', persona='y', tools_factory=lambda: [], schedule_tool_names=['a','b']); print(v.schedule_tool_names)"` prints `['a', 'b']`

`uv run ruff check tests/eval/variants/registry.py` passes.
  </verify>
  <done>ToolVariant has schedule_tool_names field. All 4 new variant modules are auto-imported. Existing baseline still works.</done>
</task>

<task type="auto">
  <name>Task 2: Create 4 isolated-variable tool variants</name>
  <files>
tests/eval/variants/tasks_rename.py
tests/eval/variants/tasks_simplify.py
tests/eval/variants/tasks_description_a.py
tests/eval/variants/tasks_description_b.py
  </files>
  <action>
Create 4 variant files following the exact patterns from RESEARCH.md. Each variant changes ONE dimension from baseline. All use `settings.persona_path.read_text()` for system prompt (same as baseline). All exclude run_code per user decision.

**tasks_rename.py** — `@register("rename")`
- Tools: `calendar_create_event`, `calendar_list_events`, `calendar_update_event` (3 tools, no run_code)
- Params: IDENTICAL to baseline (calendar_create_event has title, description, when, delay_seconds, recurring -- same as schedule_task)
- Descriptions: IDENTICAL to baseline (copy DESC_FIXED verbatim, just replace function name in examples). list_tasks/update_task descriptions also identical, just function names changed.
- schedule_tool_name: `"calendar_create_event"`

**tasks_simplify.py** — `@register("simplify")`
- Tools: `schedule_task`, `list_tasks`, `update_task` (3 tools, same names as baseline, no run_code)
- Params: schedule_task reduced to 3 params: `title: str, description: str, when: int | str = ""`
  - Merges when+delay_seconds+recurring into single typed `when` (int=seconds, str with T=ISO datetime, str with spaces=cron)
- Description: Updated to explain the typed when param (see RESEARCH.md DESC for simplify). Keep examples format.
- list_tasks and update_task: IDENTICAL to baseline
- schedule_tool_name: `"schedule_task"`

**tasks_description_a.py** — `@register("description_a")`
- Tools: `schedule_task`, `list_tasks`, `update_task` (3 tools, same names as baseline, no run_code)
- Params: IDENTICAL to baseline
- Description for schedule_task: Structured What/When-to-use/How format (see RESEARCH.md DESC_STRUCTURED). List_tasks and update_task get similarly structured descriptions.
- schedule_tool_name: `"schedule_task"`

**tasks_description_b.py** — `@register("description_b")`
- Tools: `schedule_task`, `list_tasks`, `update_task` (3 tools, same names as baseline, no run_code)
- Params: IDENTICAL to baseline
- Description for schedule_task: Minimal examples-first (see RESEARCH.md DESC_MINIMAL). One-line summary + examples. List_tasks and update_task get similarly minimal descriptions.
- schedule_tool_name: `"schedule_task"`

For all variants, use `StructuredTool.from_function()` for the schedule tool (needs dynamic description injection) and `@tool` decorator for list/update tools (simpler, static descriptions).

Use the exact description text from RESEARCH.md code examples. No negative guidance in any description.
  </action>
  <verify>
```bash
uv run python -c "
from tests.eval.variants.registry import VARIANTS
for name in ['baseline', 'rename', 'simplify', 'description_a', 'description_b']:
    v = VARIANTS[name]
    tools = v.tools_factory()
    print(f'{name}: {len(tools)} tools, schedule={v.schedule_tool_name}, names={[t.name for t in tools]}')
"
```
Expected output: baseline has 4 tools (incl run_code), others have 3 tools each. Rename has calendar_* names. Others have schedule_task/list_tasks/update_task.

`uv run ruff check tests/eval/variants/` passes.
  </verify>
  <done>5 variants registered in VARIANTS dict (baseline + 4 new). Each isolated variant changes exactly one dimension. No run_code in experimental variants. Descriptions match RESEARCH.md specifications.</done>
</task>

</tasks>

<verification>
- `uv run python -c "from tests.eval.variants.registry import VARIANTS; print(sorted(VARIANTS.keys()))"` shows `['baseline', 'description_a', 'description_b', 'rename', 'simplify']`
- `uv run ruff check tests/eval/variants/` has no errors
- `uv run ty check tests/eval/variants/` has no errors (or only pre-existing ones)
</verification>

<success_criteria>
5 variants are registered and importable. Each isolated variant changes exactly one dimension from baseline. Rename uses app-like names. Simplify merges timing params. Description A uses structured format. Description B uses minimal format. All share the baseline system prompt.
</success_criteria>

<output>
After completion, create `.planning/phases/03-app-like-variant-design/03-01-SUMMARY.md`
</output>
