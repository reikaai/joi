services:
  # mcp:
  #   build: .
  #   command: uv run python -m joi_mcp.server
  #   ports:
  #     - "8000:8000"
  #   env_file: .env

  # agent:
  #   build: .
  #   command: uv run python -m joi_agent.server
  #   ports:
  #     - "7777:8000"
  #   env_file: .env
  #   environment:
  #     MCP_URL: http://mcp:8000
  #   depends_on:
  #     mcp:
  #       condition: service_healthy
  #   volumes:
  #     - data:/app/data
  #     - logs:/app/logs

  # telegram:
  #   build: .
  #   command: uv run python -m joi_telegram.main
  #   env_file: .env
  #   environment:
  #     AGENTOS_URL: http://agent:8000
  #   depends_on:
  #     agent:
  #       condition: service_healthy
  #   volumes:
  #     - logs:/app/logs
  #   healthcheck:
  #     test: ["CMD", "pgrep", "-f", "joi_telegram"]
  #     interval: 30s
  #     timeout: 3s
  #     start_period: 5s

  # langfuse-db:
  #   image: postgres:16
  #   environment:
  #     POSTGRES_USER: langfuse
  #     POSTGRES_PASSWORD: langfuse
  #     POSTGRES_DB: langfuse
  #   volumes:
  #     - langfuse-db:/var/lib/postgresql/data
  #   healthcheck:
  #     test: ["CMD-SHELL", "pg_isready -U langfuse"]
  #     interval: 5s
  #     timeout: 5s
  #     retries: 5

  # langfuse:
  #   image: langfuse/langfuse:latest
  #   ports:
  #     - "3000:3000"
  #   environment:
  #     DATABASE_URL: postgresql://langfuse:langfuse@langfuse-db:5432/langfuse
  #     NEXTAUTH_SECRET: mysecret
  #     NEXTAUTH_URL: http://localhost:3000
  #     SALT: mysalt
  #   depends_on:
  #     langfuse-db:
  #       condition: service_healthy

  # agent-langgraph:
  #   build: .
  #   command: uv run langgraph dev --host 0.0.0.0 --port 2024
  #   ports:
  #     - "2024:2024"
  #   env_file: .env
  #   environment:
  #     MCP_URL: http://mcp:8000
  #   depends_on:
  #     mcp:
  #       condition: service_healthy
  #   volumes:
  #     - data:/app/data
  #     - logs:/app/logs

  # telegram-langgraph:
  #   build: .
  #   command: uv run python -m joi_telegram_langgraph.main
  #   env_file: .env
  #   environment:
  #     LANGGRAPH_URL: http://agent-langgraph:8000
  #   depends_on:
  #     agent-langgraph:
  #       condition: service_started
  #   volumes:
  #     - logs:/app/logs

  playwright-mcp:
    image: mcr.microsoft.com/playwright/mcp:latest
    init: true
    entrypoint: ["node", "cli.js", "--headless", "--browser", "chromium", "--no-sandbox", "--port", "8931", "--host", "0.0.0.0", "--allowed-hosts", "*"]
    ports:
      - "3100:8931"
    shm_size: "1g"

volumes:
  data:
  logs:
  langfuse-db:
